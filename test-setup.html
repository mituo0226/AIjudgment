<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒãƒ£ãƒƒãƒˆãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿è¨­å®š</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #0d0d1a;
      color: #fff;
      font-family: "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
      padding: 20px;
      line-height: 1.6;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.1);
      padding: 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(102, 204, 255, 0.3);
    }
    
    h1 {
      color: #66ccff;
      text-align: center;
      margin-bottom: 30px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      color: #66ccff;
      font-weight: bold;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid rgba(102, 204, 255, 0.3);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #66ccff;
      box-shadow: 0 0 10px rgba(102, 204, 255, 0.3);
    }
    
    .button-group {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }
    
    button {
      flex: 1;
      padding: 15px;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
    }
    
    .setup-btn {
      background: linear-gradient(90deg, #66ccff, #3399ff);
      color: #000;
    }
    
    .setup-btn:hover {
      background: linear-gradient(90deg, #99e0ff, #66ccff);
      transform: translateY(-2px);
    }
    
    .open-btn {
      background: linear-gradient(90deg, #9d4edd, #7b2cbf);
      color: #fff;
    }
    
    .open-btn:hover {
      background: linear-gradient(90deg, #b366e6, #9d4edd);
      transform: translateY(-2px);
    }
    
    .preset-btn {
      background: linear-gradient(90deg, #ff6b6b, #ee5a52);
      color: #fff;
      margin-bottom: 20px;
    }
    
    .preset-btn:hover {
      background: linear-gradient(90deg, #ff8e8e, #ff6b6b);
      transform: translateY(-2px);
    }
    
    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
    }
    
    .status.success {
      background: rgba(76, 175, 80, 0.2);
      border: 1px solid rgba(76, 175, 80, 0.5);
      color: #4caf50;
    }
    
    .status.error {
      background: rgba(244, 67, 54, 0.2);
      border: 1px solid rgba(244, 67, 54, 0.5);
      color: #f44336;
    }
    
    .current-data {
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(102, 204, 255, 0.2);
    }
    
    .current-data h3 {
      color: #66ccff;
      margin-top: 0;
    }
    
    .current-data pre {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”® ãƒãƒ£ãƒƒãƒˆãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿è¨­å®š</h1>
    
    <button class="preset-btn" onclick="setPresetData()">ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š</button>
    
    <div class="form-group">
      <label for="nickname">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </label>
      <input type="text" id="nickname" value="ãƒ†ã‚¹ãƒˆå¤ªéƒ" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›">
    </div>
    
    <div class="form-group">
      <label for="birthYear">ç”Ÿå¹´</label>
      <input type="number" id="birthYear" value="1990" min="1900" max="2010">
    </div>
    
    <div class="form-group">
      <label for="birthMonth">ç”Ÿæœˆ</label>
      <select id="birthMonth">
        <option value="1">1æœˆ</option>
        <option value="2">2æœˆ</option>
        <option value="3">3æœˆ</option>
        <option value="4" selected>4æœˆ</option>
        <option value="5">5æœˆ</option>
        <option value="6">6æœˆ</option>
        <option value="7">7æœˆ</option>
        <option value="8">8æœˆ</option>
        <option value="9">9æœˆ</option>
        <option value="10">10æœˆ</option>
        <option value="11">11æœˆ</option>
        <option value="12">12æœˆ</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="birthDay">ç”Ÿæ—¥</label>
      <input type="number" id="birthDay" value="15" min="1" max="31">
    </div>
    
    <div class="form-group">
      <label for="guardianKey">å®ˆè­·ç¥</label>
      <select id="guardianKey">
        <option value="senju">åƒæ‰‹è¦³éŸ³è©è–©ï¼ˆå­å¹´ï¼‰</option>
        <option value="kokuzo">è™šç©ºè”µè©è–©ï¼ˆä¸‘ãƒ»å¯…å¹´ï¼‰</option>
        <option value="monju" selected>æ–‡æ®Šè©è–©ï¼ˆå¯å¹´ï¼‰</option>
        <option value="fugen">æ™®è³¢è©è–©ï¼ˆè¾°ãƒ»å·³å¹´ï¼‰</option>
        <option value="seishi">å‹¢è‡³è©è–©ï¼ˆåˆå¹´ï¼‰</option>
        <option value="dainichi">å¤§æ—¥å¦‚æ¥ï¼ˆæœªãƒ»ç”³å¹´ï¼‰</option>
        <option value="fudo">ä¸å‹•æ˜ç‹ï¼ˆé…‰å¹´ï¼‰</option>
        <option value="amida">é˜¿å¼¥é™€å¦‚æ¥ï¼ˆæˆŒå¹´ï¼‰</option>
        <option value="yakushi">è–¬å¸«å¦‚æ¥ï¼ˆäº¥å¹´ï¼‰</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="worry">ç›¸è«‡å†…å®¹</label>
      <textarea id="worry" rows="4" placeholder="ãƒ†ã‚¹ãƒˆç”¨ã®ç›¸è«‡å†…å®¹ã‚’å…¥åŠ›">ä»•äº‹ã§ã®ã‚¹ãƒˆãƒ¬ã‚¹ãŒå¤šãã€å°†æ¥ã¸ã®ä¸å®‰ã‚‚æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ã©ã®ã‚ˆã†ã«å‘ãåˆã£ã¦ã„ã‘ã°ã‚ˆã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ</textarea>
    </div>
    
    <div class="form-group">
      <label for="ticketMinutes">ãƒã‚±ãƒƒãƒˆæ™‚é–“ï¼ˆåˆ†ï¼‰</label>
      <input type="number" id="ticketMinutes" value="10" min="1" max="999">
    </div>
    
    <div class="button-group">
      <button class="setup-btn" onclick="setupTestData()">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š</button>
      <button class="open-btn" onclick="openChatPage()">ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‚’é–‹ã</button>
    </div>
    
    <div id="status"></div>
    
    <div class="current-data">
      <h3>ç¾åœ¨ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h3>
      <div>
        <strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿:</strong>
        <pre id="currentUserData">ãƒ‡ãƒ¼ã‚¿ãªã—</pre>
      </div>
      <div>
        <strong>ãƒã‚±ãƒƒãƒˆæ™‚é–“:</strong>
        <pre id="currentTicketData">ãƒ‡ãƒ¼ã‚¿ãªã—</pre>
      </div>
      <button onclick="clearAllData()" style="background: #ff6b6b; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px;">å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
    </div>
  </div>

  <script>
    // å®ˆè­·ç¥ãƒ‡ãƒ¼ã‚¿
    const guardians = {
      senju: { name: 'åƒæ‰‹è¦³éŸ³è©è–©', image: 'senju.png' },
      kokuzo: { name: 'è™šç©ºè”µè©è–©', image: 'kokuzo.png' },
      monju: { name: 'æ–‡æ®Šè©è–©', image: 'monju.png' },
      fugen: { name: 'æ™®è³¢è©è–©', image: 'fugen.png' },
      seishi: { name: 'å‹¢è‡³è©è–©', image: 'seishi.png' },
      dainichi: { name: 'å¤§æ—¥å¦‚æ¥', image: 'dainichi.png' },
      fudo: { name: 'ä¸å‹•æ˜ç‹', image: 'fudo.png' },
      amida: { name: 'é˜¿å¼¥é™€å¦‚æ¥', image: 'amida.png' },
      yakushi: { name: 'è–¬å¸«å¦‚æ¥', image: 'yakushi.png' }
    };

    // ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
    function setPresetData() {
      document.getElementById('nickname').value = 'ãƒ†ã‚¹ãƒˆå¤ªéƒ';
      document.getElementById('birthYear').value = '1990';
      document.getElementById('birthMonth').value = '4';
      document.getElementById('birthDay').value = '15';
      document.getElementById('guardianKey').value = 'monju';
      document.getElementById('worry').value = 'ä»•äº‹ã§ã®ã‚¹ãƒˆãƒ¬ã‚¹ãŒå¤šãã€å°†æ¥ã¸ã®ä¸å®‰ã‚‚æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ã©ã®ã‚ˆã†ã«å‘ãåˆã£ã¦ã„ã‘ã°ã‚ˆã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ';
      document.getElementById('ticketMinutes').value = '10';
      
      showStatus('ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã—ãŸ', 'success');
    }

    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«è¨­å®š
    function setupTestData() {
      try {
        const nickname = document.getElementById('nickname').value;
        const birthYear = parseInt(document.getElementById('birthYear').value);
        const birthMonth = parseInt(document.getElementById('birthMonth').value);
        const birthDay = parseInt(document.getElementById('birthDay').value);
        const guardianKey = document.getElementById('guardianKey').value;
        const worry = document.getElementById('worry').value;
        const ticketMinutes = parseInt(document.getElementById('ticketMinutes').value);

        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        if (!nickname || !birthYear || !birthMonth || !birthDay || !guardianKey || !ticketMinutes) {
          throw new Error('å…¨ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        }

        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
        const userData = {
          nickname: nickname,
          year: birthYear,
          month: birthMonth,
          day: birthDay,
          guardian: {
            key: guardianKey,
            name: guardians[guardianKey].name
          },
          worry: worry
        };

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
        localStorage.setItem('userData', JSON.stringify(userData));
        localStorage.setItem('ticketMinutes', ticketMinutes.toString());
        
        // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚‚ä¿å­˜
        sessionStorage.setItem('ss_credit_minutes', ticketMinutes.toString());

        showStatus('ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ­£å¸¸ã«è¨­å®šã—ã¾ã—ãŸï¼', 'success');
        updateCurrentData();

      } catch (error) {
        showStatus('ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
      }
    }

    // ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‚’é–‹ã
    function openChatPage() {
      // ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
      const userData = localStorage.getItem('userData');
      const ticketMinutes = localStorage.getItem('ticketMinutes');

      if (!userData || !ticketMinutes) {
        showStatus('å…ˆã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¦ãã ã•ã„', 'error');
        return;
      }

      // ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‚’é–‹ãï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰
      const chatUrl = './chat.html';
      window.open(chatUrl, '_blank');
      
      showStatus('ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã¾ã—ãŸ', 'success');
    }

    // å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
    function clearAllData() {
      if (confirm('å…¨ã¦ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
        localStorage.clear();
        sessionStorage.clear();
        showStatus('å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ', 'success');
        updateCurrentData();
      }
    }

    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
    function showStatus(message, type) {
      const statusDiv = document.getElementById('status');
      statusDiv.textContent = message;
      statusDiv.className = `status ${type}`;
      
      // 3ç§’å¾Œã«æ¶ˆã™
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = '';
      }, 3000);
    }

    // ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
    function updateCurrentData() {
      const userData = localStorage.getItem('userData');
      const ticketMinutes = localStorage.getItem('ticketMinutes');
      const sessionMinutes = sessionStorage.getItem('ss_credit_minutes');

      document.getElementById('currentUserData').textContent = 
        userData ? JSON.stringify(JSON.parse(userData), null, 2) : 'ãƒ‡ãƒ¼ã‚¿ãªã—';
      
      document.getElementById('currentTicketData').textContent = 
        `localStorage: ${ticketMinutes || 'ãªã—'}\nsessionStorage: ${sessionMinutes || 'ãªã—'}`;
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
    window.addEventListener('load', updateCurrentData);
  </script>
</body>
</html>